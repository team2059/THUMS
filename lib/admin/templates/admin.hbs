<!DOCTYPE html>
<head>
    <meta charset="UTF-8" />
    <title>The Hitchhikers</title>
    {{> style}}
    {{> Showdown}}
</head>
<body>
    <div class="wrapper">
        {{> header}}
        <div class="content">
            <article>
                <h1 id="page-title">{{title}}</h1>
                <noscript><h2>Please enable JavaScript to enable full features.</h2></noscript>
                {{#if modules}}
                <textarea id="inputPane" cols="80" rows="20" class="pane"></textarea>
                {{> modules}}
                <script>
                    var module_data = {};
                    {{#each modules}}
                        module_data[{{id}}] = {};
                        module_data[{{id}}]["content"] = '{{{content}}}';
                    {{/each}}
                    var converter = new Showdown.converter();
                    var text_input = document.getElementById("inputPane");
                    var modules = document.getElementsByClassName('module');
                    var preview = modules[0].getElementsByClassName("section-content")[0];
                    text_input.value = module_data[preview.parentElement.id]["content"];
                    text_input.addEventListener('keyup', function(e) {
                        preview.innerHTML = converter.makeHtml(text_input.value);
                        module_data[preview.parentElement.id]["content"] = text_input.value;
                    });
                    for (var x = 0; x < modules.length; x++) {
                        modules[x].addEventListener('click', function(e){
                            preview = this.getElementsByClassName("section-content")[0];
                            text_input.value = module_data[preview.parentElement.id]["content"];
                        })
                    }
                </script>
                {{/if}}
                {{#each posts}}
                <section>
                    <h1><a href="/admin/{{slug}}/edit">{{title}}</a></h1>
                </section>
                {{/each}}
            </article>
        </div>
    </div>
</body>
</html>